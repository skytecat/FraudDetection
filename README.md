# Обнаружение мошеннических транзакций

## Описание проекта

Цель данного проекта — разработка модели машинного обучения для обнаружения мошеннических транзакций по данным кредитных карт. Задача является задачей бинарной классификации, где целевая переменная (`Class`) принимает значение:
- `1` — мошенническая транзакция.
- `0` — легальная транзакция.

Данные представляют собой транзакции, произведенные европейскими держателями кредитных карт в сентябре 2013 года. Особенностью датасета является **сильный дисбаланс классов**: только **492 из 284,807 транзакций (0.172%)** являются мошенническими.

## Содержание датасета

Датасет содержит следующие признаки:
- **V1, V2, ..., V28:** Основные компоненты, полученные с помощью PCA (метод главных компонент). Исходные признаки не раскрываются из соображений конфиденциальности.
- **Time:** Время в секундах, прошедшее между каждой транзакцией и первой транзакцией в датасете.
- **Amount:** Сумма транзакции.
- **Class:** Целевая переменная:
  - `0` — легальная транзакция.
  - `1` — мошенническая транзакция.

## Проблемы и подходы

### Проблема дисбаланса классов
Доля мошеннических транзакций составляет всего **0.172%**, что создает сложности для обучения моделей:
- Модели могут быть склонны к предсказанию мажоритарного класса, игнорируя миноритарный.
- Стандартные метрики, такие как **Accuracy**, становятся ненадежными, так как высокая точность может быть достигнута простым предсказанием мажоритарного класса.

### Подходы к решению
Для работы с дисбалансом классов я использовала следующие методы:
1. **Методы балансировки данных:**
   - **SMOTE (Synthetic Minority Oversampling Technique):** Генерация новых примеров миноритарного класса.
   - **Random Oversampling:** Увеличение числа примеров миноритарного класса за счет дублирования.
   - **Random Undersampling:** Уменьшение числа примеров мажоритарного класса.
2. **Метрики качества:**
   - Я использовала метрики, которые адекватно оценивают качество модели в условиях дисбаланса:
     - **Precision (Точность):** Минимизация ложных срабатываний.
     - **Recall (Полнота):** Минимизация пропущенных случаев мошенничества.
     - **F1-Score:** Баланс между Precision и Recall.
     - **AUPRC (Area Under the Precision-Recall Curve):** Основная метрика для сравнения моделей.

## Используемые модели

Мы сравниваем несколько моделей машинного обучения:
1. **Логистическая регрессия**
2. **Случайный лес**

Каждая модель обучается как на исходных данных, так и на данных, преобразованных с помощью методов балансировки.

## Инструкции по запуску

### Предварительные требования
Для запуска проекта необходимы следующие библиотеки Python:
```bash
numpy
pandas
matplotlib
seaborn
scikit-learn
imbalanced-learn
```

Установите зависимости с помощью pip:
```bash
pip install -r requirements.txt
```

### Структура проекта
```
FraudDetection/
│
├── README.md               # Описание проекта
├── FraudDetection.ipynb          # Ноутбук с анализом и моделями
├── data/                   # Директория с данными
│   └── creditcard.csv      # Исходный датасет
├── requirements.txt        # Список зависимостей
└── models/                 # Сохраненные модели
```

### Запуск ноутбука
1. Скачайте датасет и поместите его в директорию `data/`.
2. Откройте ноутбук `FraudDetection.ipynb`.
3. Выполните ячейки для загрузки данных, обучения моделей и оценки их качества.

## Результаты

Результаты экспериментов представлены в ноутбуке. Модели оценивались по метрике **AUPRC**, так как она наиболее информативна для задач с дисбалансом классов. Лучшая модель выбирается на основе этой метрики.
